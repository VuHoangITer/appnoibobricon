{% extends "base.html" %}

{% block title %}Hi·ªáu ·ª®ng Theo M√πa{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/seasonal-effects.css') }}">
<style>
/* ============================================
   SANTA CLAUS ANIMATION - √îNG GI√Ä NOEL T·∫∂NG QU√Ä
   ============================================ */

.santa-container {
    position: fixed;
    bottom: -200px;
    right: -200px;
    z-index: 10000;
    pointer-events: none;
    animation: santaEnter 8s ease-in-out forwards;
}

.santa-character {
    font-size: 120px;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
    animation: santaWave 1s ease-in-out infinite;
}

.santa-gift {
    position: absolute;
    font-size: 60px;
    bottom: 20px;
    right: 120px;
    opacity: 0;
    transform: scale(0);
    /* 5s: kho·∫£ng 2s bung, 3s ƒë·ª©ng y√™n */
    animation: giftAppear 5s ease-out 3s forwards;
}

.santa-message {
    position: absolute;
    top: -80px;
    right: 0;
    background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
    color: white;
    padding: 15px 25px;
    border-radius: 20px;
    font-size: 18px;
    font-weight: 600;
    white-space: nowrap;
    box-shadow: 0 8px 20px rgba(231, 76, 60, 0.4);
    opacity: 0;
    transform: translateY(20px);
    animation: messageAppear 1s ease-out 2s forwards, messageFade 1s ease-in 6s forwards;
}

.santa-message::after {
    content: '';
    position: absolute;
    bottom: -10px;
    right: 60px;
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid #c0392b;
}

@keyframes santaEnter {
    0% {
        bottom: -200px;
        right: -200px;
        transform: scale(0.5);
    }
    20% {
        bottom: 50px;
        right: 50px;
        transform: scale(1);
    }
    80% {
        bottom: 50px;
        right: 50px;
        transform: scale(1);
    }
    100% {
        bottom: -200px;
        right: -200px;
        transform: scale(0.5);
        opacity: 0;
    }
}

@keyframes santaWave {
    0%, 100% {
        transform: rotate(-5deg);
    }
    50% {
        transform: rotate(5deg);
    }
}

@keyframes giftAppear {
    0% {
        opacity: 0;
        transform: scale(0) rotate(0deg);
    }

    30% {
        opacity: 1;
        transform: scale(1.2) rotate(360deg);
    }

    40% {
        opacity: 1;
        transform: scale(1.1) rotate(360deg);
    }

    100% {
        opacity: 1;
        transform: scale(1.1) rotate(360deg);
    }
}

@keyframes messageAppear {
    0% {
        opacity: 0;
        transform: translateY(20px) scale(0.8);
    }
    100% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes messageFade {
    0% {
        opacity: 1;
    }
    100% {
        opacity: 0;
    }
}

.santa-sparkle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: #ffd700;
    border-radius: 50%;
    animation: sparkle 1.5s ease-in-out infinite;
    box-shadow: 0 0 10px #ffd700;
}

@keyframes sparkle {
    0%, 100% {
        opacity: 0;
        transform: scale(0);
    }
    50% {
        opacity: 1;
        transform: scale(1);
    }
}

@media (max-width: 768px) {
    .santa-container {
        bottom: -150px;
        right: -150px;
    }
    .santa-character {
        font-size: 80px;
    }
    .santa-gift {
        font-size: 40px;
        bottom: 15px;
        right: 80px;
    }
    .santa-message {
        font-size: 14px;
        padding: 10px 18px;
        top: -60px;
    }
    @keyframes santaEnter {
        0% {
            bottom: -150px;
            right: -150px;
            transform: scale(0.5);
        }
        20% {
            bottom: 30px;
            right: 30px;
            transform: scale(1);
        }
        80% {
            bottom: 30px;
            right: 30px;
            transform: scale(1);
        }
        100% {
            bottom: -150px;
            right: -150px;
            transform: scale(0.5);
            opacity: 0;
        }
    }
}

@media (max-width: 480px) {
    .santa-character {
        font-size: 60px;
    }
    .santa-gift {
        font-size: 30px;
        bottom: 10px;
        right: 60px;
    }
    .santa-message {
        font-size: 12px;
        padding: 8px 15px;
        top: -50px;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="seasonal-settings-container">
    <h2 style="margin-bottom: 30px; color: #2c3e50; font-weight: 700;">
        <i class="bi bi-palette-fill"></i> Qu·∫£n L√Ω Hi·ªáu ·ª®ng Theo M√πa
    </h2>

    <!-- SNOWFALL EFFECT -->
    <div class="effect-card" id="card-snowfall">
        <div class="effect-header">
            <div class="effect-title">
                <i class="bi bi-snow" style="color: #4fc3f7;"></i>
                <span>Tuy·∫øt R∆°i</span>
            </div>
            <label class="effect-toggle">
                <input type="checkbox" id="toggle-snowfall" onchange="toggleEffect('snowfall')">
                <span class="effect-toggle-slider"></span>
            </label>
        </div>

        <div class="effect-controls">
            <div class="control-group">
                <label class="control-label">
                    Th·ªùi gian (gi√¢y): <span class="slider-value" id="value-snowfall-duration">0</span>
                    <small style="color: #6c757d; display: block; margin-top: 4px;">0 = Kh√¥ng gi·ªõi h·∫°n</small>
                </label>
                <input type="range" class="control-slider" id="slider-snowfall-duration"
                       min="0" max="300" value="0" step="10"
                       oninput="updateSliderValue('snowfall', 'duration', this.value)">
            </div>

            <div class="control-group">
                <label class="control-label">
                    M·∫≠t ƒë·ªô: <span class="slider-value" id="value-snowfall-intensity">50</span>
                </label>
                <input type="range" class="control-slider" id="slider-snowfall-intensity"
                       min="10" max="100" value="50"
                       oninput="updateSliderValue('snowfall', 'intensity', this.value)">
            </div>

            <div class="control-group">
                <label class="control-label">T·ªëc ƒë·ªô</label>
                <select class="control-input" id="select-snowfall-speed" onchange="updateSelectValue('snowfall', 'speed', this.value)">
                    <option value="slow">Ch·∫≠m</option>
                    <option value="medium" selected>Trung b√¨nh</option>
                    <option value="fast">Nhanh</option>
                </select>
            </div>

            <!-- PAGES SELECTOR - SNOWFALL -->
            <div class="control-group">
                <label class="control-label">Hi·ªÉn th·ªã tr√™n trang</label>
                <div class="pages-selector" id="pages-snowfall">
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="all" onchange="updatePageSelection('snowfall')">
                        <span>T·∫•t c·∫£ trang</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="hub" onchange="updatePageSelection('snowfall')">
                        <span>Trang Ch·ªß</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="tasks" onchange="updatePageSelection('snowfall')">
                        <span>Nhi·ªám V·ª•</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="news" onchange="updatePageSelection('snowfall')">
                        <span>Tin T·ª©c</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="files" onchange="updatePageSelection('snowfall')">
                        <span>T·ªáp Tin</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="notes" onchange="updatePageSelection('snowfall')">
                        <span>Ghi Ch√∫</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="salaries" onchange="updatePageSelection('snowfall')">
                        <span>L∆∞∆°ng</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="performance" onchange="updatePageSelection('snowfall')">
                        <span>Hi·ªáu Su·∫•t</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="employees" onchange="updatePageSelection('snowfall')">
                        <span>Nh√¢n Vi√™n</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- FIREWORKS EFFECT -->
    <div class="effect-card" id="card-fireworks">
        <div class="effect-header">
            <div class="effect-title">
                <i class="bi bi-stars" style="color: #ffd700;"></i>
                <span>Ph√°o Hoa</span>
            </div>
            <label class="effect-toggle">
                <input type="checkbox" id="toggle-fireworks" onchange="toggleEffect('fireworks')">
                <span class="effect-toggle-slider"></span>
            </label>
        </div>

        <div class="effect-controls">
            <div class="control-group">
                <label class="control-label">
                    Th·ªùi gian (gi√¢y): <span class="slider-value" id="value-fireworks-duration">0</span>
                    <small style="color: #6c757d; display: block; margin-top: 4px;">0 = Kh√¥ng gi·ªõi h·∫°n</small>
                </label>
                <input type="range" class="control-slider" id="slider-fireworks-duration"
                       min="0" max="300" value="0" step="10"
                       oninput="updateSliderValue('fireworks', 'duration', this.value)">
            </div>

            <div class="control-group">
                <label class="control-label">
                    M·∫≠t ƒë·ªô: <span class="slider-value" id="value-fireworks-intensity">50</span>
                </label>
                <input type="range" class="control-slider" id="slider-fireworks-intensity"
                       min="10" max="100" value="50"
                       oninput="updateSliderValue('fireworks', 'intensity', this.value)">
            </div>

            <div class="control-group">
                <label class="control-label">
                    T·∫ßn su·∫•t (ms): <span class="slider-value" id="value-fireworks-frequency">1500</span>
                </label>
                <input type="range" class="control-slider" id="slider-fireworks-frequency"
                       min="500" max="3000" value="1500" step="100"
                       oninput="updateSliderValue('fireworks', 'frequency', this.value)">
            </div>

            <div class="control-group">
                <label class="control-label">M√†u s·∫Øc</label>
                <div class="color-picker-group" id="colors-fireworks">
                    <input type="color" class="color-picker" value="#ff0000" data-index="0">
                    <input type="color" class="color-picker" value="#ffd700" data-index="1">
                    <input type="color" class="color-picker" value="#00ff00" data-index="2">
                    <input type="color" class="color-picker" value="#0000ff" data-index="3">
                    <input type="color" class="color-picker" value="#ff00ff" data-index="4">
                </div>
            </div>

            <!-- PAGES SELECTOR - FIREWORKS -->
            <div class="control-group">
                <label class="control-label">Hi·ªÉn th·ªã tr√™n trang</label>
                <div class="pages-selector" id="pages-fireworks">
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="all" onchange="updatePageSelection('fireworks')">
                        <span>T·∫•t c·∫£ trang</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="hub" onchange="updatePageSelection('fireworks')">
                        <span>Trang Ch·ªß</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="tasks" onchange="updatePageSelection('fireworks')">
                        <span>Nhi·ªám V·ª•</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="news" onchange="updatePageSelection('fireworks')">
                        <span>Tin T·ª©c</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="files" onchange="updatePageSelection('fireworks')">
                        <span>T·ªáp Tin</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="notes" onchange="updatePageSelection('fireworks')">
                        <span>Ghi Ch√∫</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="salaries" onchange="updatePageSelection('fireworks')">
                        <span>L∆∞∆°ng</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="performance" onchange="updatePageSelection('fireworks')">
                        <span>Hi·ªáu Su·∫•t</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="employees" onchange="updatePageSelection('fireworks')">
                        <span>Nh√¢n Vi√™n</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- NOEL EFFECT -->
    <div class="effect-card" id="card-noel">
        <div class="effect-header">
            <div class="effect-title">
                <span style="font-size: 2rem;">üéÑ</span>
                <span>Gi√°ng Sinh (üéÑüéÅ)</span>
            </div>
            <label class="effect-toggle">
                <input type="checkbox" id="toggle-noel" onchange="toggleEffect('noel')">
                <span class="effect-toggle-slider"></span>
            </label>
        </div>

        <div class="effect-controls">
            <div class="control-group">
                <label class="control-label">
                    Th·ªùi gian (gi√¢y): <span class="slider-value" id="value-noel-duration">0</span>
                    <small style="color: #6c757d; display: block; margin-top: 4px;">0 = Kh√¥ng gi·ªõi h·∫°n</small>
                </label>
                <input type="range" class="control-slider" id="slider-noel-duration"
                       min="0" max="300" value="0" step="10"
                       oninput="updateSliderValue('noel', 'duration', this.value)">
            </div>

            <div class="control-group">
                <label class="control-label">
                    M·∫≠t ƒë·ªô: <span class="slider-value" id="value-noel-intensity">50</span>
                </label>
                <input type="range" class="control-slider" id="slider-noel-intensity"
                       min="10" max="100" value="50"
                       oninput="updateSliderValue('noel', 'intensity', this.value)">
            </div>

            <!-- PAGES SELECTOR - NOEL -->
            <div class="control-group">
                <label class="control-label">Hi·ªÉn th·ªã tr√™n trang</label>
                <div class="pages-selector" id="pages-noel">
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="all" onchange="updatePageSelection('noel')">
                        <span>T·∫•t c·∫£ trang</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="hub" onchange="updatePageSelection('noel')">
                        <span>Trang Ch·ªß</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="tasks" onchange="updatePageSelection('noel')">
                        <span>Nhi·ªám V·ª•</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="news" onchange="updatePageSelection('noel')">
                        <span>Tin T·ª©c</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="files" onchange="updatePageSelection('noel')">
                        <span>T·ªáp Tin</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="notes" onchange="updatePageSelection('noel')">
                        <span>Ghi Ch√∫</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="salaries" onchange="updatePageSelection('noel')">
                        <span>L∆∞∆°ng</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="performance" onchange="updatePageSelection('noel')">
                        <span>Hi·ªáu Su·∫•t</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="employees" onchange="updatePageSelection('noel')">
                        <span>Nh√¢n Vi√™n</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- TET EFFECT -->
    <div class="effect-card" id="card-tet">
        <div class="effect-header">
            <div class="effect-title">
                <span style="font-size: 2rem;">üßß</span>
                <span>T·∫øt Nguy√™n ƒê√°n</span>
            </div>
            <label class="effect-toggle">
                <input type="checkbox" id="toggle-tet" onchange="toggleEffect('tet')">
                <span class="effect-toggle-slider"></span>
            </label>
        </div>

        <div class="effect-controls">
            <div class="control-group">
                <label class="control-label">
                    Th·ªùi gian (gi√¢y): <span class="slider-value" id="value-tet-duration">0</span>
                    <small style="color: #6c757d; display: block; margin-top: 4px;">0 = Kh√¥ng gi·ªõi h·∫°n</small>
                </label>
                <input type="range" class="control-slider" id="slider-tet-duration"
                       min="0" max="300" value="0" step="10"
                       oninput="updateSliderValue('tet', 'duration', this.value)">
            </div>

            <div class="control-group">
                <label class="control-label">
                    M·∫≠t ƒë·ªô: <span class="slider-value" id="value-tet-intensity">50</span>
                </label>
                <input type="range" class="control-slider" id="slider-tet-intensity"
                       min="10" max="100" value="50"
                       oninput="updateSliderValue('tet', 'intensity', this.value)">
            </div>

            <!-- PAGES SELECTOR - TET -->
            <div class="control-group">
                <label class="control-label">Hi·ªÉn th·ªã tr√™n trang</label>
                <div class="pages-selector" id="pages-tet">
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="all" onchange="updatePageSelection('tet')">
                        <span>T·∫•t c·∫£ trang</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="hub" onchange="updatePageSelection('tet')">
                        <span>Trang Ch·ªß</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="tasks" onchange="updatePageSelection('tet')">
                        <span>Nhi·ªám V·ª•</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="news" onchange="updatePageSelection('tet')">
                        <span>Tin T·ª©c</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="files" onchange="updatePageSelection('tet')">
                        <span>T·ªáp Tin</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="notes" onchange="updatePageSelection('tet')">
                        <span>Ghi Ch√∫</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="salaries" onchange="updatePageSelection('tet')">
                        <span>L∆∞∆°ng</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="performance" onchange="updatePageSelection('tet')">
                        <span>Hi·ªáu Su·∫•t</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="employees" onchange="updatePageSelection('tet')">
                        <span>Nh√¢n Vi√™n</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- FLAGS EFFECT -->
    <div class="effect-card" id="card-flags">
        <div class="effect-header">
            <div class="effect-title">
                <i class="bi bi-flag-fill" style="color: #da251d;"></i>
                <span>C·ªù Bay (30/4 - Qu·ªëc Kh√°nh)</span>
            </div>
            <label class="effect-toggle">
                <input type="checkbox" id="toggle-flags" onchange="toggleEffect('flags')">
                <span class="effect-toggle-slider"></span>
            </label>
        </div>

        <div class="effect-controls">
            <div class="control-group">
                <label class="control-label">
                    Th·ªùi gian (gi√¢y): <span class="slider-value" id="value-flags-duration">0</span>
                    <small style="color: #6c757d; display: block; margin-top: 4px;">0 = Kh√¥ng gi·ªõi h·∫°n</small>
                </label>
                <input type="range" class="control-slider" id="slider-flags-duration"
                       min="0" max="300" value="0" step="10"
                       oninput="updateSliderValue('flags', 'duration', this.value)">
            </div>

            <div class="control-group">
                <label class="control-label">
                    M·∫≠t ƒë·ªô: <span class="slider-value" id="value-flags-intensity">50</span>
                </label>
                <input type="range" class="control-slider" id="slider-flags-intensity"
                       min="10" max="100" value="50"
                       oninput="updateSliderValue('flags', 'intensity', this.value)">
            </div>

            <!-- PAGES SELECTOR - FLAGS -->
            <div class="control-group">
                <label class="control-label">Hi·ªÉn th·ªã tr√™n trang</label>
                <div class="pages-selector" id="pages-flags">
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="all" onchange="updatePageSelection('flags')">
                        <span>T·∫•t c·∫£ trang</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="hub" onchange="updatePageSelection('flags')">
                        <span>Trang Ch·ªß</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="tasks" onchange="updatePageSelection('flags')">
                        <span>Nhi·ªám V·ª•</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="news" onchange="updatePageSelection('flags')">
                        <span>Tin T·ª©c</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="files" onchange="updatePageSelection('flags')">
                        <span>T·ªáp Tin</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="notes" onchange="updatePageSelection('flags')">
                        <span>Ghi Ch√∫</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="salaries" onchange="updatePageSelection('flags')">
                        <span>L∆∞∆°ng</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="performance" onchange="updatePageSelection('flags')">
                        <span>Hi·ªáu Su·∫•t</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="employees" onchange="updatePageSelection('flags')">
                        <span>Nh√¢n Vi√™n</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- SANTA EFFECT - √îNG GI√Ä NOEL -->
    <div class="effect-card" id="card-santa">
        <div class="effect-header">
            <div class="effect-title">
                <span style="font-size: 2rem;">üéÖ</span>
                <span>√îng Gi√† Noel T·∫∑ng Qu√†</span>
            </div>
            <label class="effect-toggle">
                <input type="checkbox" id="toggle-santa" onchange="toggleEffect('santa')">
                <span class="effect-toggle-slider"></span>
            </label>
        </div>

        <div class="effect-controls">
            <div class="control-group">
                <label class="control-label">Tin nh·∫Øn</label>
                <input type="text" class="control-input" id="input-santa-message"
                       value="Ch√∫c M·ª´ng Gi√°ng Sinh! üéÑ"
                       placeholder="Nh·∫≠p tin nh·∫Øn c·ªßa √¥ng gi√† Noel">
            </div>

            <div class="control-group">
                <label class="control-label">
                    Th·ªùi gian ch·ªù (gi√¢y): <span class="slider-value" id="value-santa-delay">1</span>
                    <small style="color: #6c757d; display: block; margin-top: 4px;">Delay tr∆∞·ªõc khi xu·∫•t hi·ªán</small>
                </label>
                <input type="range" class="control-slider" id="slider-santa-delay"
                       min="0" max="10" value="1" step="1"
                       oninput="updateSliderValue('santa', 'delay', this.value)">
            </div>

            <div class="control-group">
                <label class="control-label">
                    <input type="checkbox" id="checkbox-santa-sparkles" checked style="width: auto; margin-right: 8px;">
                    Hi·ªáu ·ª©ng l·∫•p l√°nh
                </label>
            </div>

            <!-- PAGES SELECTOR - SANTA -->
            <div class="control-group">
                <label class="control-label">Hi·ªÉn th·ªã tr√™n trang</label>
                <div class="pages-selector" id="pages-santa">
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="all" onchange="updatePageSelection('santa')">
                        <span>T·∫•t c·∫£ trang</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="hub" onchange="updatePageSelection('santa')">
                        <span>Trang Ch·ªß</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="tasks" onchange="updatePageSelection('santa')">
                        <span>Nhi·ªám V·ª•</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="news" onchange="updatePageSelection('santa')">
                        <span>Tin T·ª©c</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="files" onchange="updatePageSelection('santa')">
                        <span>T·ªáp Tin</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="notes" onchange="updatePageSelection('santa')">
                        <span>Ghi Ch√∫</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="salaries" onchange="updatePageSelection('santa')">
                        <span>L∆∞∆°ng</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="performance" onchange="updatePageSelection('santa')">
                        <span>Hi·ªáu Su·∫•t</span>
                    </label>
                    <label class="page-checkbox">
                        <input type="checkbox" class="page-check" value="employees" onchange="updatePageSelection('santa')">
                        <span>Nh√¢n Vi√™n</span>
                    </label>
                </div>
            </div>
        </div>

        <div class="effect-actions">
            <button class="btn-effect btn-reset" onclick="resetSantaSession()" style="background: #ff9800; color: white;">
                <i class="bi bi-arrow-clockwise"></i> Reset Session
            </button>
        </div>
    </div>

    <!-- GLOBAL ACTIONS -->
    <div class="global-actions">
        <div class="current-effect-status">
            <i class="bi bi-info-circle"></i>
            Hi·ªáu ·ª©ng ƒëang b·∫≠t: <strong id="current-effect-name">Kh√¥ng c√≥</strong>
        </div>
        <button class="btn-stop-all" onclick="stopAllEffects()">
            <i class="bi bi-stop-circle"></i>
            T·∫Øt T·∫•t C·∫£ Hi·ªáu ·ª®ng
        </button>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/seasonal-effects.js') }}"></script>
<script>
// ============================================
// SANTA EFFECT - INLINE VERSION
// ============================================
const SantaEffect = {
    isShowing: false,
    container: null,

    show(config = {}) {
        if (this.isShowing) {
            console.log('üéÖ Santa is already showing');
            return;
        }

        console.log('üéÖ Santa Claus is coming to town!');
        this.isShowing = true;

        const message = config.message || 'Ch√∫c M·ª´ng Gi√°ng Sinh! üéÑ';

        this.container = document.createElement('div');
        this.container.className = 'santa-container';
        this.container.innerHTML = `
            <div class="santa-message">${message}</div>
            <div class="santa-character">üéÖ</div>
            <div class="santa-gift">üéÅ</div>
        `;

        if (config.sparkles !== false) {
            this.addSparkles();
        }

        document.body.appendChild(this.container);

        setTimeout(() => {
            this.hide();
        }, 8000);
    },

    addSparkles() {
        const sparkleCount = 20;

        for (let i = 0; i < sparkleCount; i++) {
            setTimeout(() => {
                const sparkle = document.createElement('div');
                sparkle.className = 'santa-sparkle';

                const x = Math.random() * 150 - 50;
                const y = Math.random() * 150 - 50;
                sparkle.style.left = x + 'px';
                sparkle.style.top = y + 'px';
                sparkle.style.animationDelay = Math.random() * 1 + 's';

                this.container.appendChild(sparkle);

                setTimeout(() => {
                    if (sparkle.parentNode) {
                        sparkle.parentNode.removeChild(sparkle);
                    }
                }, 2000);
            }, i * 100);
        }
    },

    hide() {
        if (this.container && this.container.parentNode) {
            this.container.parentNode.removeChild(this.container);
            this.container = null;
            this.isShowing = false;
            console.log('üéÖ Santa has left the building');
        }
    },

    showOnPageLoad(config = {}) {
        const hasShownToday = sessionStorage.getItem('santa_shown_today');

        if (hasShownToday) {
            console.log('üéÖ Santa already appeared today');
            return;
        }

        const delay = config.delay || 1000;

        setTimeout(() => {
            this.show(config);
            sessionStorage.setItem('santa_shown_today', 'true');
        }, delay);
    }
};

window.SantaEffect = SantaEffect;

window.IS_SEASONAL_SETTINGS_PAGE = true;

// ==========================================
// SETTINGS PAGE CONTROLLER
// ==========================================

let previewTimeout = null;

// Load current config when page loads
document.addEventListener('DOMContentLoaded', function() {
    // Wait for SeasonalEffects to finish loading config from server
    setTimeout(function() {
        loadCurrentConfig();
    }, 1000);
})

function loadCurrentConfig() {
    if (!window.SeasonalEffects) {
        console.error('SeasonalEffects not loaded');
        return;
    }

    const config = SeasonalEffects.config;

    if (!config || !config.effects) {
        console.warn('‚ö†Ô∏è Config not ready yet, waiting...');
        setTimeout(loadCurrentConfig, 500);
        return;
    }

    // Update UI for each effect
    Object.keys(config.effects).forEach(effectName => {
        const effectConfig = config.effects[effectName];

        // Update toggle
        const toggle = document.getElementById(`toggle-${effectName}`);
        if (toggle) {
            toggle.checked = effectConfig.active;
        }

        // Update card active state
        const card = document.getElementById(`card-${effectName}`);
        if (card && effectConfig.active) {
            card.classList.add('active');
        }

        // Update specific controls based on effect type
        updateEffectControls(effectName, effectConfig);

        // Update pages checkboxes
        updatePagesCheckboxes(effectName, effectConfig.pages || ['all']);
    });

    // Update current effect status
    updateCurrentEffectStatus();
}

function updateEffectControls(effectName, config) {
    // Update duration (common for all - except santa)
    updateControl(`slider-${effectName}-duration`, config.duration || 0);

    // Update sliders and selects based on effect type
    if (effectName === 'snowfall') {
        updateControl('slider-snowfall-intensity', config.intensity || 50);
        updateControl('select-snowfall-speed', config.speed);
    } else if (effectName === 'fireworks') {
        updateControl('slider-fireworks-frequency', config.frequency);
        updateControl('slider-fireworks-intensity', config.intensity || 50);
        const colorPickers = document.querySelectorAll('#colors-fireworks .color-picker');
        (config.colors || []).forEach((color, index) => {
            if (colorPickers[index]) {
                colorPickers[index].value = color;
            }
        });
    } else if (effectName === 'noel') {
        updateControl('slider-noel-intensity', config.intensity || 50);
    } else if (effectName === 'tet') {
        updateControl('slider-tet-intensity', config.intensity || 50);
    } else if (effectName === 'flags') {
        updateControl('slider-flags-intensity', config.intensity || 50);
    } else if (effectName === 'santa') {
        const messageInput = document.getElementById('input-santa-message');
        if (messageInput) {
            messageInput.value = config.message || 'Ch√∫c M·ª´ng Gi√°ng Sinh! üéÑ';
        }

        const delaySlider = document.getElementById('slider-santa-delay');
        const delayValue = document.getElementById('value-santa-delay');
        if (delaySlider && delayValue) {
            const delaySeconds = Math.floor((config.delay || 1000) / 1000);
            delaySlider.value = delaySeconds;
            delayValue.textContent = delaySeconds;
        }

        const sparklesCheckbox = document.getElementById('checkbox-santa-sparkles');
        if (sparklesCheckbox) {
            sparklesCheckbox.checked = config.sparkles !== false;
        }
    }
}

function updateControl(id, value) {
    const element = document.getElementById(id);
    if (element) {
        element.value = value;
        // Update display value if it's a slider
        if (element.type === 'range') {
            const valueDisplay = document.getElementById('value-' + id.replace('slider-', ''));
            if (valueDisplay) {
                valueDisplay.textContent = value;
            }
        }
    }
}

// ==========================================
// PAGES SELECTOR FUNCTIONS
// ==========================================

function updatePagesCheckboxes(effectName, pages) {
    const pagesContainer = document.getElementById(`pages-${effectName}`);
    if (!pagesContainer) {
        console.warn(`Pages container not found for effect: ${effectName}`);
        return;
    }

    const checkboxes = pagesContainer.querySelectorAll('.page-check');
    checkboxes.forEach(checkbox => {
        checkbox.checked = pages.includes(checkbox.value);
    });
}

function updatePageSelection(effectName) {
    const pagesContainer = document.getElementById(`pages-${effectName}`);
    if (!pagesContainer) return;

    const checkboxes = pagesContainer.querySelectorAll('.page-check');
    let selectedPages = Array.from(checkboxes)
        .filter(cb => cb.checked)
        .map(cb => cb.value);

    // N·∫øu ch·ªçn "all", b·ªè ch·ªçn c√°c trang kh√°c
    if (selectedPages.includes('all')) {
        checkboxes.forEach(cb => {
            if (cb.value !== 'all') {
                cb.checked = false;
            }
        });
        selectedPages = ['all'];
    } else {
        // N·∫øu ch·ªçn trang c·ª• th·ªÉ, b·ªè ch·ªçn "all"
        const allCheckbox = pagesContainer.querySelector('[value="all"]');
        if (allCheckbox && selectedPages.length > 0) {
            allCheckbox.checked = false;
        }

        // N·∫øu kh√¥ng ch·ªçn g√¨ c·∫£, m·∫∑c ƒë·ªãnh l√† empty array (kh√¥ng hi·ªÉn th·ªã ·ªü trang n√†o)
        if (selectedPages.length === 0) {
            selectedPages = [];
        }
    }

    // Update config
    if (!window.SeasonalEffects.config.effects[effectName]) {
        window.SeasonalEffects.config.effects[effectName] = {};
    }
    window.SeasonalEffects.config.effects[effectName].pages = selectedPages.length > 0 ? selectedPages : ['all'];

    console.log(`üìç Pages updated for ${effectName}:`, selectedPages);
}

// ==========================================
// SLIDER & SELECT HANDLERS
// ==========================================

function updateSliderValue(effectName, param, value) {
    const valueDisplay = document.getElementById(`value-${effectName}-${param}`);
    if (valueDisplay) {
        valueDisplay.textContent = value;
    }
}

function updateSelectValue(effectName, param, value) {
    // Value updated automatically by select
}

async function toggleEffect(effectName) {
    const toggle = document.getElementById(`toggle-${effectName}`);
    const card = document.getElementById(`card-${effectName}`);

    if (!window.SeasonalEffects) {
        alert('‚ö†Ô∏è H·ªá th·ªëng hi·ªáu ·ª©ng ch∆∞a s·∫µn s√†ng!');
        toggle.checked = false;
        return;
    }

    if (toggle.checked) {
        // B·∫¨T hi·ªáu ·ª©ng
        card.classList.add('active');

        // L·∫•y config t·ª´ UI
        const config = getEffectConfigFromUI(effectName);

        // C·∫≠p nh·∫≠t config
        SeasonalEffects.config.effects[effectName] = config;

        // B·∫≠t hi·ªáu ·ª©ng
        SeasonalEffects.startEffect(effectName, config);

        // L∆∞u v√†o server
        const saved = await SeasonalEffects.saveConfig();

        if (!saved) {
            alert('‚ö†Ô∏è C√≥ l·ªói khi l∆∞u, vui l√≤ng th·ª≠ l·∫°i!');
            toggle.checked = false;
            card.classList.remove('active');
            return;
        }

        // C·∫≠p nh·∫≠t tr·∫°ng th√°i
        updateCurrentEffectStatus();

        // Th√¥ng b√°o
        const pages = config.pages.join(', ');
        if (config.duration > 0) {
            console.log(`‚úÖ ${effectName} B·∫¨T - ${config.duration}s tr√™n: ${pages}`);
        } else {
            console.log(`‚úÖ ${effectName} B·∫¨T (v√¥ h·∫°n) tr√™n: ${pages}`);
        }

    } else {
        // T·∫ÆT hi·ªáu ·ª©ng
        card.classList.remove('active');

        // T·∫Øt hi·ªáu ·ª©ng
        SeasonalEffects.stopEffect(effectName);

        // L∆∞u v√†o server
        await SeasonalEffects.saveConfig();

        // C·∫≠p nh·∫≠t tr·∫°ng th√°i
        updateCurrentEffectStatus();

        console.log(`üõë ${effectName} T·∫ÆT`);
    }
}

// ==========================================
// EFFECT ACTIONS
// ==========================================
async function stopAllEffects() {
    if (!window.SeasonalEffects) return;

    // T·∫Øt t·∫•t c·∫£ hi·ªáu ·ª©ng
    SeasonalEffects.stopAllEffects();

    // L∆∞u config
    await SeasonalEffects.saveConfig();

    // C·∫≠p nh·∫≠t UI
    updateCurrentEffectStatus();

    // Update all cards and toggles
    document.querySelectorAll('.effect-card').forEach(card => {
        card.classList.remove('active');
    });
    document.querySelectorAll('[id^="toggle-"]').forEach(toggle => {
        toggle.checked = false;
    });

    alert('üõë ƒê√£ t·∫Øt t·∫•t c·∫£ hi·ªáu ·ª©ng!');
}

function getEffectConfigFromUI(effectName) {
    const config = { active: true };

    // Get duration (common for all - except santa)
    const durationSlider = document.getElementById(`slider-${effectName}-duration`);
    if (durationSlider) {
        config.duration = parseInt(durationSlider.value);
    }

    // Get pages
    const pagesContainer = document.getElementById(`pages-${effectName}`);
    if (pagesContainer) {
        const checkboxes = pagesContainer.querySelectorAll('.page-check');
        const selectedPages = Array.from(checkboxes)
            .filter(cb => cb.checked)
            .map(cb => cb.value);
        config.pages = selectedPages.length > 0 ? selectedPages : ['all'];
    } else {
        config.pages = ['all'];
    }

    // Get effect-specific configs
    if (effectName === 'snowfall') {
        config.intensity = parseInt(document.getElementById('slider-snowfall-intensity').value);
        config.speed = document.getElementById('select-snowfall-speed').value;
    } else if (effectName === 'fireworks') {
        config.frequency = parseInt(document.getElementById('slider-fireworks-frequency').value);
        config.intensity = parseInt(document.getElementById('slider-fireworks-intensity').value);
        const colorPickers = document.querySelectorAll('#colors-fireworks .color-picker');
        config.colors = Array.from(colorPickers).map(picker => picker.value);
    } else if (effectName === 'noel') {
        config.intensity = parseInt(document.getElementById('slider-noel-intensity').value);
    } else if (effectName === 'tet') {
        config.intensity = parseInt(document.getElementById('slider-tet-intensity').value);
    } else if (effectName === 'flags') {
        config.intensity = parseInt(document.getElementById('slider-flags-intensity').value);
    } else if (effectName === 'santa') {
        config.message = document.getElementById('input-santa-message').value || 'Ch√∫c M·ª´ng Gi√°ng Sinh! üéÑ';
        config.delay = parseInt(document.getElementById('slider-santa-delay').value) * 1000;
        config.sparkles = document.getElementById('checkbox-santa-sparkles').checked;
    }

    return config;
}

function updateCurrentEffectStatus() {
    const statusElement = document.getElementById('current-effect-name');
    if (!statusElement || !window.SeasonalEffects) return;

    const effectNames = {
        'snowfall': '‚ùÑÔ∏è Tuy·∫øt R∆°i',
        'fireworks': 'üéÜ Ph√°o Hoa',
        'noel': 'üéÑ Gi√°ng Sinh',
        'tet': 'üßß T·∫øt',
        'flags': 'üáªüá≥ C·ªù Bay',
        'santa': 'üéÖ √îng Gi√† Noel'
    };

    const config = SeasonalEffects.config;
    const activeEffects = [];

    Object.keys(config.effects).forEach(effectName => {
        if (config.effects[effectName].active) {
            activeEffects.push(effectNames[effectName]);
        }
    });

    if (activeEffects.length === 0) {
        statusElement.textContent = 'Kh√¥ng c√≥';
    } else {
        statusElement.textContent = activeEffects.join(', ');
    }
}

// ==========================================
// RESET SANTA SESSION
// ==========================================
function resetSantaSession() {
    sessionStorage.removeItem('santa_shown_today');
    alert('‚úÖ ƒê√£ x√≥a session! Santa s·∫Ω xu·∫•t hi·ªán l·∫°i khi reload trang (n·∫øu ƒë√£ b·∫≠t).');
    console.log('üóëÔ∏è Santa session cleared');
}
</script>
{% endblock %}